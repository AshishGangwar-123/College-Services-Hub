<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Request Service</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
.card-shadow{box-shadow:0 6px 18px rgba(0,0,0,0.08);}
.theme-light { --bg:#0f172a; --text:#1e293b; --card:#ffffff; }
body { background:var(--bg); color:var(--text); transition:.2s; font-family:sans-serif; }
.bg-card { background-color: var(--card); }
</style>
</head>
<body class="theme-light min-h-screen flex items-center justify-center p-4">

<div id="formPage" class="bg-card card-shadow p-6 rounded-xl w-full max-w-md">
  <h2 class="text-2xl font-semibold mb-4 text-center">Request Service</h2>
  <p class="text-sm text-slate-500 mb-2">
  <b>Fill this form for selected service</b> <b id="selectedService"></b>
</p>

  <form id="requestForm" class="space-y-3">
    <input required id="r_name" class="w-full p-2 border rounded" placeholder="Your Name">
    <input required id="r_email" class="w-full p-2 border rounded" placeholder="Your Email">
    <input required id="r_phone" class="w-full p-2 border rounded" placeholder="Phone / WhatsApp">
    <input required id="r_service" class="w-full p-2 border rounded" placeholder="Service Name" hidden>
    <textarea id="r_details" rows="4" class="w-full p-2 border rounded" placeholder="Project details / Requirements (optional)"></textarea>
    <button class="w-full bg-indigo-600 text-white py-2 rounded">Submit Request</button>
  </form>
</div>

<!-- Thank you & Contact -->
<div id="successPage" class="hidden bg-card card-shadow p-6 rounded-xl w-full max-w-md text-center">
  <h2 class="text-2xl font-semibold mb-2 text-green-600">Request Submitted âœ”</h2>
  <p class="text-slate-500 mb-4">We will contact you shortly. Meanwhile, you can contact us directly:</p>

  <div class="flex justify-center gap-6 text-3xl">
    <a id="emailBtn" href="#" title="Email">ðŸ“§</a>
    <a id="waBtn" href="#" title="WhatsApp">ðŸ’¬</a>
  </div>

  <button id="backHome" class="mt-6 bg-indigo-600 text-white px-4 py-2 rounded">
    Back to Home
  </button>
</div>

<script>
const STORAGE_KEY = "service_requests_v1";

// helper
function qsGet(name){
  const url = new URL(location.href);
  return url.searchParams.get(name);
}

function saveRequest(data){
  const list = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
  list.unshift(data);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
}

function escapeHtml(s=''){ return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }

document.addEventListener('DOMContentLoaded', ()=>{
  // prefill service if provided in query
  const pre = qsGet('service');
  if(pre) document.getElementById('r_service').value = decodeURIComponent(pre);

  const form = document.getElementById("requestForm");
  form.addEventListener("submit", e => {
    e.preventDefault();

    const req = {
      name: document.getElementById('r_name').value.trim(),
      email: document.getElementById('r_email').value.trim(),
      phone: document.getElementById('r_phone').value.trim(),
      service: document.getElementById('r_service').value.trim(),
      details: document.getElementById('r_details').value.trim(),
      date: new Date().toLocaleString()
    };

    saveRequest(req);

    // Show success page
    document.getElementById("formPage").classList.add("hidden");
    document.getElementById("successPage").classList.remove("hidden");

    // Contact icons dynamic â€” replace with your contact details
    const MY_EMAIL = "your@email.com";
    const MY_WHATSAPP = "91XXXXXXXXXX"; // with country code
    document.getElementById("emailBtn").href = `mailto:${MY_EMAIL}?subject=Service Request: ${encodeURIComponent(req.service)}&body=${encodeURIComponent('Name: '+req.name+'%0AEmail: '+req.email+'%0APhone: '+req.phone+'%0ADetails: '+req.details)}`;
    document.getElementById("waBtn").href = `https://wa.me/${MY_WHATSAPP.replace(/\D/g,'')}?text=${encodeURIComponent('Hello, I submitted a request for: '+req.service+' (Name: '+req.name+')')}`;

    // Back to home link
    document.getElementById('backHome').addEventListener('click', ()=>{ window.location.href = 'index.html'; });
  });
});
</script>
</body>
</html>
